<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">
        <record id="email_template_test_result" model="mail.template">
            <field name="name">Test Result: Send by Email</field>
            <field name="model_id" ref="rawdah_laboratory_management.model_test_result"/>
            <field name="subject">Laboratory Test Result - {{ object.result_no }}</field>
            <field name="email_from">{{ (object.env.user.email_formatted or user.email_formatted) }}</field>
            <field name="partner_to">{{ object.patient_id.id }}</field>
            <field name="description">Sent to patient when result is done</field>

            <!-- ODOO 17 CHANGE: Use report_template_ids (Many2many) -->
            <field name="report_template_ids" eval="[(4, ref('rawdah_laboratory_management.action_test_result_report_result'))]"/>

            <field name="body_html" type="html">
                <div style="margin: 0px; padding: 0px;">
                    <p style="margin: 0px; padding: 0px; font-size: 13px;">
                        Dear <t t-out="object.patient_id.name or ''">Patient</t>,<br/><br/>
                        Please find attached the laboratory test result (Ref: <strong t-out="object.result_no or ''"></strong>).
                        <br/><br/>
                        Best regards,<br/>
                        <t t-out="object.env.company.name or ''">My Laboratory</t>
                    </p>
                </div>
            </field>
        </record>
    </data>
</odoo>